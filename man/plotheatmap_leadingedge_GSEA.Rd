% Generated by roxygen2; do not edit by hand
\name{plotheatmap_leadingedge_GSEA}
\alias{plotheatmap_leadingedge_GSEA}
\title{Plot leading edge heatmaps from GSEA results}
\usage{
plotheatmap_leadingedge_GSEA(
  main_dir_2 = NULL,
  expression_file,
  metadata_file,
  gmt_file,
  ranked_genes_file,
  gsea_file,
  output_dir = "leading_edge_heatmaps",
  sample_col = "Sample",
  group_col = "group",
  save_dataframe = FALSE
)
}
\arguments{
  \item{main_dir_2}{Optional base directory to prepend to all file paths.}
  \item{expression_file}{Path to the expression data file (tab-delimited) or relative to \code{main_dir_2}.}
  \item{metadata_file}{Path to the metadata file (Excel) or relative to \code{main_dir_2}.}
  \item{gmt_file}{Path to the GMT file defining gene sets or relative to \code{main_dir_2}.}
  \item{ranked_genes_file}{Path to the ranked genes list file or relative to \code{main_dir_2}.}
  \item{gsea_file}{Path to the GSEA results file with leading edge genes or relative to \code{main_dir_2}.}
  \item{output_dir}{Directory to save heatmap outputs and optional TSV; default \code{"leading_edge_heatmaps"}.}
  \item{sample_col}{Name of the sample ID column in metadata; default \code{"Sample"}.}
  \item{group_col}{Name of the group column in metadata; default \code{"group"}.}
  \item{save_dataframe}{Logical; if \code{TRUE}, saves the merged data frame as TSV before plotting.}
}
\description{
Generates and saves per-geneset heatmaps of leading edge genes from GSEA results.  
Reads input files, extracts top-ranked leading edge genes, and plots expression heatmaps.
}
\details{
This function performs the following steps:
\enumerate{
  \item Reads a GMT file to map gene set names to member genes.
  \item Reads GSEA output and merges in the full gene lists for each gene set.
  \item Reads a ranked gene list and determines the order for leading edge extraction.
  \item Calculates the leading-edge size (\code{SIZE * tags}) and extracts the top genes accordingly.
  \item Optionally saves the intermediate merged data frame to a TSV file.
  \item Reads expression and metadata tables, aligns sample names, and prepares annotation.
  \item Iterates over each gene set, selecting expression rows for the leading edge genes, and writes a heatmap (PDF and JPG) to \code{output_dir}.
}
}
\value{
No return value; files are written to disk. A message indicates the final output directory.
}
\examples{
\dontrun{
plotheatmap_leadingedge_GSEA(
  main_dir_2         = "C:/Projects/project1",
  expression_file    = "Results/expression_data.txt",
  metadata_file      = "sample_data.xlsx",
  gmt_file           = "GSEA/genesets.gmt",
  ranked_genes_file  = "Ranking/ranked_gene_list.tsv",
  gsea_file          = "GSEA/gsea_results.tsv",
  output_dir         = "LeadingEdgePlots",
  sample_col         = "id",
  group_col          = "group",
  save_dataframe     = TRUE
)
}
}
